name: ðŸŒ€ å¹²å‘å¸ƒï¼ˆDry Releaseï¼‰

on:
  workflow_call:
    inputs:
      simulateResult:
        description: "æ¨¡æ‹Ÿå‘å¸ƒæ˜¯å¦æˆåŠŸæˆ–å¤±è´¥"
        required: true
        default: 'success'
        type: string
    outputs:
      releaseErrorMessage:
        description: "æ¨¡æ‹Ÿçš„å‘å¸ƒé”™è¯¯ä¿¡æ¯"
        value: ${{ jobs.dry_release.outputs.releaseErrorMessage }}

jobs:
  dry_release:
    name: ðŸ§ª æ¨¡æ‹Ÿå‘å¸ƒ
    runs-on: ubuntu-latest
    outputs:
      releaseErrorMessage: ${{ steps.simulate.outputs.releaseErrorMessage }}
    steps:
      - name: æ¨¡æ‹Ÿå‘å¸ƒç»“æžœ
        id: simulate
        run: |
          RESULT="${{ inputs.simulateResult }}"
          MESSAGE=""

          case "$RESULT" in
            success)
              MESSAGE=""
              echo "âœ… æ¨¡æ‹Ÿå‘å¸ƒæˆåŠŸã€‚"
              ;;
            no_artifacts)
              MESSAGE="æœªæ‰¾åˆ°äº§ç‰©"
              echo "âŒ æ¨¡æ‹Ÿï¼šæœªæ‰¾åˆ°äº§ç‰©ã€‚"
              ;;
            api_failure)
              MESSAGE="åˆ›å»ºæˆ–èŽ·å– GitHub å‘å¸ƒå¤±è´¥"
              echo "âŒ æ¨¡æ‹Ÿï¼šAPI å¤±è´¥ã€‚"
              ;;
            upload_failure)
              MESSAGE="ä¸€ä¸ªæˆ–å¤šä¸ªä¸Šä¼ æ­¥éª¤å¤±è´¥"
              echo "âŒ æ¨¡æ‹Ÿï¼šä¸Šä¼ å¤±è´¥ã€‚"
              ;;
            unknown_failure)
              MESSAGE="æœªçŸ¥çš„å‘å¸ƒå¤±è´¥"
              echo "âŒ æ¨¡æ‹Ÿï¼šæœªçŸ¥å¤±è´¥ã€‚"
              ;;
            *)
              MESSAGE="æœªçŸ¥çš„æ¨¡æ‹Ÿè¾“å…¥"
              echo "âŒ æ— æ•ˆçš„ simulateResult è¾“å…¥: $RESULT"
              ;;
          esac

          echo "releaseErrorMessage=$MESSAGE" >> $GITHUB_OUTPUT

      - name: å¯é€‰æ‘˜è¦è¾“å‡º
        run: |
          if [[ -n "${{ steps.simulate.outputs.releaseErrorMessage }}" ]]; then
            echo "### âŒ æ¨¡æ‹Ÿå‘å¸ƒå¤±è´¥" >> $GITHUB_STEP_SUMMARY
            echo "${{ steps.simulate.outputs.releaseErrorMessage }}" >> $GITHUB_STEP_SUMMARY
          else
            echo "### âœ… æ¨¡æ‹Ÿå‘å¸ƒæˆåŠŸ" >> $GITHUB_STEP_SUMMARY
          fi